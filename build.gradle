plugins {
	id "java"
	id "application"
	id "com.github.johnrengelman.shadow" version "1.2.2"
}

sourceCompatibility = 1.8
group = "se.gustavkarlsson.aurora-notifier"
version = "1.0-SNAPSHOT"
mainClassName = "se.gustavkarlsson.aurora_notifier.web_service.app.AuroraApplication"

wrapper() {
	gradleVersion = "2.7"
}

repositories {
	mavenCentral()
	maven { url "https://jitpack.io" }
}

dependencies {
	ext {
		junitVersion = "4.12"
		dropwizardVersion = "0.8.2"
		jsoupVersion = "1.8.3"
		commonVersion = "aurora-notifier-common-1.2.0"
		dropwizardGuiceVersion = "0.8.3.0"
	}

	testCompile "junit:junit:" + junitVersion
	compile "io.dropwizard:dropwizard-core:" + dropwizardVersion
	compile "io.dropwizard:dropwizard-metrics:" + dropwizardVersion
	compile "org.jsoup:jsoup:" + jsoupVersion
	compile "com.github.gustavkarlsson:aurora-notifier-common:" + commonVersion
	compile "com.hubspot.dropwizard:dropwizard-guice:" + dropwizardGuiceVersion
}

jar {
	manifest {
		attributes "Implementation-Title": name,
				"Implementation-Version": version,
				"Built-By": System.getProperty("user.name"),
				"Built-Date": new Date(),
				"Built-JDK": System.getProperty("java.version"),
				"Main-Class": mainClassName
	}
}

shadowJar {
	mergeServiceFiles {
		exclude "META-INF/*.SF"
		exclude "META-INF/*.DSA"
		exclude "META-INF/*.RSA"
	}
}

task stage(dependsOn: ["clean", "shadowJar"])

defaultTasks "stage"
