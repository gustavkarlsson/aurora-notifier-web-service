repositories {
    mavenCentral()
    maven {
        url "repo"
    }
}

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath "com.github.jengelman.gradle.plugins:shadow:0.8"
    }
}

apply plugin: "java"
apply plugin: "application"
apply plugin: "shadow"

sourceCompatibility = 1.7
group = "se.gustavkarlsson.aurora-notifier"
version = "1.0-SNAPSHOT"
mainClassName = "se.gustavkarlsson.aurora_notifier.web_service.app.AuroraNotifierWebServiceApplication"

wrapper() {
    gradleVersion = "1.10"
}

dependencies {
	ext {
		junitVersion = "4.12"
		dropwizardVersion = "0.8.2"
		jsoupVersion = "1.8.3"
		auroraNotifierVersion = "1.0-SNAPSHOT"
	}

	testCompile "junit:junit:" + junitVersion
	compile "io.dropwizard:dropwizard-core:" + dropwizardVersion
	compile "io.dropwizard:dropwizard-metrics:" + dropwizardVersion
	compile "org.jsoup:jsoup:" + jsoupVersion
	compile "se.gustavkarlsson.aurora-notifier:aurora-notifier-common:" + auroraNotifierVersion
}

jar {
    manifest {
        attributes "Implementation-Title": name,
                "Implementation-Version": version,
                "Built-By": System.getProperty("user.name"),
                "Built-Date": new Date(),
                "Built-JDK": System.getProperty("java.version"),
                "Main-Class": "se.gustavkarlsson.aurora_notifier_web_service.app.AuroraNotifierWebServiceApplication"
    }
}

import com.github.jengelman.gradle.plugins.shadow.transformers.ServiceFileTransformer

shadow {
    transformer(ServiceFileTransformer)
    exclude "META-INF/*.SF"
    exclude "META-INF/*.DSA"
    exclude "META-INF/*.RSA"
}

task stage(dependsOn: ["clean", "shadowJar"])

defaultTasks "stage"
